/* jquery.poptrox.js v2.3.4 | (c) n33 | n33.co | MIT licensed */
(function(e){var t="trigger",n="height",r="css",i="fadeSpeed",s="poptrox_close",o="width",u="position",a="stopPropagation",f=!1,l="popupNavPreviousSelector",c="length",h="poptrox_switch",p="px",d="absolute",v=!0,m="stopSpinning",g="click",y="text-align",b="popupCaptionSelector",w="popupNavNextSelector",E="text-indent",S="popupCloserSelector",x="popupLoaderSelector",T="font-size",N="poptrox_previous",C="none",k=null,L="popupCaptionHeight",A="preventDefault",O="cursor",M="fadeIn",_="line-height",D="poptrox_reset",P="poptrox_next",H="overflow",B="center",j="popupTextColor",F="poptrox_disableSelection",I="object",q="popupHeight",R="pointer",U="margin-top",z="color",W="load",X="#000000",V="update",$="outline",J="left",K="usePopupNav",Q="</div>",G="0",Y='<div class="',Z="z-index",et="top",tt="captionText",nt="background",rt="startSpinning",it="40px",st="auto",ot="poptrox_open",ut="poptrox",at="popupCloserText",ft="body",lt="popupLoaderText",ct="usePopupEasyClose",ht="margin-left",pt="baseZIndex",dt="soundcloud",vt="image",mt="hide",gt="popupSelector",yt="#FFFFFF",bt="useBodyOverflow",wt="xfin",Et="relative",St="youtube",xt="type";e.fn[F]=function(){return e(this)[r]("user-select",C)[r]("-khtml-user-select",C)[r]("-moz-user-select",C)[r]("-o-user-select",C)[r]("-webkit-user-select",C)},e.fn[ut]=function(_t){function un(){It=e(window)[o](),qt=e(window)[n]()+Pt.windowHeightPad}var Dt,Pt,Ht,Bt,jt,Ft,It,qt,Rt,Ut,zt,Wt,Xt,Vt,$t,Jt,Kt,Qt,Gt,Yt,Zt,en,tn,nn,rn,sn,on;if(this[c]>1){for(Dt=0;Dt<this[c];Dt++)e(this[Dt])[ut](_t);return e(this)}return Pt=e.extend({preload:f,baseZIndex:1e3,fadeSpeed:300,overlayColor:X,overlayOpacity:.6,overlayClass:"poptrox-overlay",windowMargin:50,windowHeightPad:0,selector:"a",popupSpeed:300,popupWidth:200,popupHeight:100,popupIsFixed:f,useBodyOverflow:v,usePopupEasyClose:v,usePopupLoader:v,usePopupCloser:v,usePopupCaption:f,usePopupNav:f,usePopupDefaultStyling:v,popupBackgroundColor:yt,popupTextColor:X,popupLoaderTextSize:"2em",popupCloserBackgroundColor:X,popupCloserTextColor:yt,popupCloserTextSize:"20px",popupPadding:10,popupCaptionHeight:60,popupCaptionTextSize:k,popupBlankCaptionText:"(untitled)",popupCloserText:"&#215;",popupLoaderText:"&bull;&bull;&bull;&bull;",popupClass:"poptrox-popup",popupSelector:k,popupLoaderSelector:".loader",popupCloserSelector:".closer",popupCaptionSelector:".caption",popupNavPreviousSelector:".nav-previous",popupNavNextSelector:".nav-next",onPopupClose:k,onPopupOpen:k},_t),Ht=e(this),Bt=e(ft),jt=e(Y+Pt.overlayClass+'"></div>'),Ft=e(window),Rt=[],Ut=0,zt=f,Wt=new Array,Xt=navigator.userAgent.match(/MSIE ([0-9]+)\./),Vt=Xt&&RegExp.$1==6,$t=Xt&&RegExp.$1<8,Jt=Vt?d:"fixed",Pt.usePopupLoader||(Pt[x]=k),Pt.usePopupCloser||(Pt[S]=k),Pt.usePopupCaption||(Pt[b]=k),Pt[K]||(Pt[l]=k,Pt[w]=k),Pt[gt]?Kt=e(Pt[gt]):Kt=e(Y+Pt.popupClass+'">'+(Pt[x]?'<div class="loader">'+Pt[lt]+Q:"")+'<div class="pic"></div>'+(Pt[b]?'<div class="caption"></div>':"")+(Pt[S]?'<span class="closer">'+Pt[at]+"</span>":"")+(Pt[l]?'<div class="nav-previous"></div>':"")+(Pt[w]?'<div class="nav-next"></div>':"")+Q),Qt=Kt.find(".pic"),Gt=e(),Yt=Kt.find(Pt[x]),Zt=Kt.find(Pt[b]),en=Kt.find(Pt[S]),tn=Kt.find(Pt[w]),nn=Kt.find(Pt[l]),rn=tn.add(nn),Pt.usePopupDefaultStyling&&(Kt[r](nt,Pt.popupBackgroundColor),Kt[r](z,Pt[j]),Kt[r]("padding",Pt.popupPadding+p),Zt[c]>0&&(Kt[r]("padding-bottom",Pt[L]+p),Zt[r](u,d)[r](J,G)[r]("bottom",G)[r](o,"100%")[r](y,B)[r](n,Pt[L]+p)[r](_,Pt[L]+p),Pt.popupCaptionTextSize&&Zt[r](T,popupCaptionTextSize)),en[c]>0&&en.html(Pt[at])[r](T,Pt.popupCloserTextSize)[r](nt,Pt.popupCloserBackgroundColor)[r](z,Pt.popupCloserTextColor)[r]("display","block")[r](o,it)[r](n,it)[r](_,it)[r](y,B)[r](u,d)[r]("text-decoration",C)[r]($,G)[r](et,G)[r]("right","-40px"),Yt[c]>0&&Yt.html("")[r](u,Et)[r](T,Pt.popupLoaderTextSize).on(rt,function(){var i=e("<div>"+Pt[lt]+Q);i[r](n,Math.floor(Pt[q]/2)+p)[r](H,"hidden")[r](_,Math.floor(Pt[q]/2)+p)[r](y,B)[r](U,Math.floor((Kt[n]()-i[n]()+(Zt[c]>0?Zt[n]():0))/2))[r](z,Pt[j]?Pt[j]:"").on(wt,function(){i.fadeTo(300,.5,function(){i[t]("xfout")})}).on("xfout",function(){i.fadeTo(300,.05,function(){i[t](wt)})})[t](wt),Yt.append(i)}).on(m,function(){var e=Yt.find("div");e.remove()}),rn[c]==2&&(rn[r](T,"75px")[r](y,B)[r](z,"#fff")[r]("text-shadow",C)[r](n,"100%")[r](u,d)[r](et,G)[r]("opacity","0.35")[r](O,R)[r]("box-shadow","inset 0px 0px 10px 0px rgba(0,0,0,0)")[F](),Pt[ct]?(sn="100px",on="100px"):(sn="75%",on="25%"),tn[r]("right",G)[r](o,sn).html('<div style="position: absolute; height: 100px; width: 125px; top: 50%; right: 0; margin-top: -50px;">&gt;</div>'),nn[r](J,G)[r](o,on).html('<div style="position: absolute; height: 100px; width: 125px; top: 50%; left: 0; margin-top: -50px;">&lt;</div>'))),Ft.on("orientationchange",function(){Ft[t]("resize")}).resize(function(){un(),Kt[t](s)}),Zt.on(V,function(e,t){if(!t||t[c]==0)t=Pt.popupBlankCaptionText;Zt.html(t)}),en[r](O,R).on(g,function(e){return e[A](),e[a](),Kt[t](s),v}),tn.on(g,function(){Kt[t](P)}),nn.on(g,function(){Kt[t](N)}),jt.prependTo(ft)[mt](),Vt?jt[r](u,d):jt[r](u,Jt)[r](J,0)[r](et,0)[r](Z,Pt[pt])[r](o,"200%")[r](n,"200%")[r]("background-color",Pt.overlayColor),jt[r](O,R).on(g,function(e){e[A](),e[a](),Kt[t](s)}),Pt[ct]&&Qt[r](O,R).on(g,function(e){e[A](),e[a](),Kt[t](s)}),Kt.on(P,function(){var e=Ut+1;e>=Rt[c]&&(e=0),Kt[t](h,[e])}).on(N,function(){var e=Ut-1;e<0&&(e=Rt[c]-1),Kt[t](h,[e])}).on(D,function(){un(),Kt[r](u,Jt)[r](Z,Pt[pt]+1)[r](o,Pt.popupWidth+p)[r](n,Pt[q]+p)[r](J,It/2+p)[r](et,qt/2+p)[r](ht,-1*(Kt.outerWidth()/2)+p)[r](U,-1*(Kt.outerHeight()/2)+p),Yt[mt]()[t](m),Zt[mt](),en[mt](),rn[mt](),Qt[mt](),Gt.detach()}).on(ot,function(e,n){if(zt)return v;zt=v,Pt[bt]&&Bt[r](H,"hidden"),Pt.onPopupOpen&&Pt.onPopupOpen(),jt.fadeTo(Pt[i],Pt.overlayOpacity,function(){Kt[t](h,[n,v])})}).on(h,function(s,a,l){var c;if(!l&&zt)return v;zt=v,Zt[mt](),Gt.attr("src")&&Gt.attr("src",""),Gt.detach(),c=Rt[a],Gt=c[I],Gt.off(W),Qt[r](E,"-9999em").show().append(Gt),c[xt]=="ajax"?e.get(c.src,function(e){Gt.html(e),Gt[t](W)}):Gt.attr("src",c.src),c[xt]!=vt&&Gt[r](u,Et)[r]($,G)[r](Z,Pt[pt]+100)[o](c[o])[n](c[n]),Yt[t](rt)[M](300),Kt.show(),Pt.popupIsFixed?(Kt[o](Pt.popupWidth)[n](Pt[q])[r](ht,-1*(Kt.innerWidth()/2)+p)[r](U,-1*(Kt.innerHeight()/2)+p),Gt[W](function(){Gt.off(W),Yt[mt]()[t](m),Zt[t](V,[c[tt]])[M](Pt[i]),en[M](Pt[i]),Qt[r](E,0)[mt]()[M](Pt[i],function(){zt=f}),Ut=a,rn[M](Pt[i])})):Gt[W](function(){var e,s,u,l,h,p,d,v,g;Gt.off(W),un(),e=Math.abs(Kt[o]()-Kt.outerWidth()),s=Math.abs(Kt[n]()-Kt.outerHeight()),u=Gt[o](),l=Gt[n](),h=It-Pt.windowMargin*2-e,p=qt-Pt.windowMargin*2-s,Yt[mt]()[t](m);if(u>h||l>p)d=h/u,v=p/l,g=Math.min(d,v),u=Math.floor(g*u),l=Math.floor(g*l),Gt[o](u)[n](l);Kt.innerWidth()==u+e&&Kt.innerHeight()==l+s?(Zt[t](V,[c[tt]])[M](Pt[i]),en[M](Pt[i]),Qt[r](E,0)[mt]()[M](Pt[i],function(){zt=f}),Ut=a):Kt.animate({width:u,height:l,marginLeft:-1*(u/2)-e/2,marginTop:-1*(l/2)-s/2},Pt.popupSpeed,"swing",function(){Zt[t](V,[c[tt]])[M](Pt[i]),en[M](Pt[i]),Qt[r](E,0)[mt]()[M](Pt[i],function(){zt=f}),Ut=a,rn[M](Pt[i])})}),c[xt]!=vt&&Gt[t](W)}).on(s,function(){if(zt)return v;zt=v,Kt[mt]()[t](D),Pt.onPopupClose&&Pt.onPopupClose(),jt.fadeOut(Pt[i],function(){Pt[bt]&&Bt[r](H,st),zt=f})}).prependTo(ft)[mt]()[t](D),Ft.keydown(function(e){if(Kt.is(":visible"))switch(e.keyCode){case 37:case 32:if(Pt[K])return Kt[t](N),f;break;case 39:if(Pt[K])return Kt[t](P),f;break;case 27:return Kt[t](s),f}}),Ht.find(Pt.selector).each(function(i){var s,u,l,h=e(this),p=h.find("img"),d=h.data(ut),v={src:h.attr("href"),captionText:p.attr("title"),width:h.attr(o),height:h.attr(n),type:k,object:k};if(d){l=d.split(",");for(u in l)s=l[u].match(/([0-9]+)x([0-9]+)/),s&&s[c]==3?(v[o]=s[1],v[n]=s[2]):v[xt]=l[u]}if(!v[xt]){s=v.src.match(/http[s]?:\/\/([a-z0-9\.]+)\/.*/);if(!s||s[c]<3)s=[f];switch(s[1]){case"api.soundcloud.com":v[xt]=dt;break;case"youtu.be":v[xt]=St;break;case"vimeo.com":v[xt]="vimeo";break;default:v[xt]=vt}}s=v.src.match(/http([s]?):\/\/[a-z0-9\.]+\/(.*)/),s&&(v.prefix="http"+(s[1]=="s"?"s":""));switch(v[xt]){case"ignore":break;case"iframe":v[I]=e('<iframe src="" frameborder="0"></iframe>'),v[I].on(g,function(e){e[a]()})[r](O,st);break;case"ajax":v[I]=e('<div class="poptrox-ajax"></div>'),v[I].on(g,function(e){e[a]()})[r](O,st)[r](H,st);break;case dt:v[I]=e('<iframe scrolling="no" frameborder="no" src=""></iframe>'),v.src=v.prefix+"://w.soundcloud.com/player/?url="+escape(v.src),v[o]="600",v[n]="166";break;case St:v[I]=e('<iframe src="" frameborder="0" allowfullscreen="1"></iframe>'),v.src=v.prefix+"://www.youtube.com/embed/"+s[2];break;case"vimeo":v[I]=e('<iframe src="" frameborder="0" allowFullScreen="1"></iframe>'),v.src=v.prefix+"://player.vimeo.com/video/"+s[2];break;default:v[I]=e('<img src="" alt="" />'),Pt.preload&&(s=document.createElement("img"),s.src=v.src,Wt.push(s))}Rt.push(v),p.attr("title",""),v[xt]!="ignore"&&h.attr("href","")[r]($,0).on(g,function(e){e[A](),e[a](),Kt[t](ot,[i])})}),e(this)}})(jQuery);
